register_concrete (serialization)
concrete_include (PUBLIC "${CMAKE_CURRENT_SOURCE_DIR}")
concrete_sources ("*.c")
concrete_require (SCOPE PUBLIC ABSTRACT reflection INTERFACE stream)
concrete_require (SCOPE PRIVATE ABSTRACT error log memory threading CONCRETE_INTERFACE container readable_data)
c_interface_scanner_setup (GLOB "*.c" "*.h")

set (KAN_SERIALIZATION_BINARY_SCRIPT_INITIAL_BUCKETS "16" CACHE STRING
        "Initial buckets count for binary serialization script storage.")
set (KAN_SERIALIZATION_BINARY_GENERATION_INITIAL_STACK "65536" CACHE STRING
        "Initial stack size for binary serialization script generation algorithm.")
set (KAN_SERIALIZATION_BINARY_INTERNED_STRING_BUCKETS "16" CACHE STRING
        "Initial buckets count for binary serialization interned string lookup storage.")
set (KAN_SERIALIZATION_BINARY_INTERNED_STRING_CAPACITY "16" CACHE STRING
        "Initial capacity for interned string lookup generation temporary dynamic array.")
set (KAN_SERIALIZATION_BINARY_INTERNED_REGISTRY_BUCKETS "128" CACHE STRING
        "Initial buckets count for binary serialization interned string registry value to index map.")
set (KAN_SERIALIZATION_RD_MAX_PARTS_IN_OUTPUT_TARGET "16" CACHE STRING
        "Serializer supports up to this count of parts in readable data output target identifier.")
set (KAN_SERIALIZATION_RD_READER_STACK_INITIAL_CAPACITY "8" CACHE STRING
        "Initial capacity for readable data reader block stack.")
set (KAN_SERIALIZATION_RD_WRITE_MAX_PACKED_ARRAY_SIZE "8" CACHE STRING
        "Initial capacity for readable data reader block stack.")
set (KAN_SERIALIZATION_RD_WRITER_STACK_INITIAL_CAPACITY "8" CACHE STRING
        "Initial capacity for readable data writer block stack.")
set (KAN_SERIALIZATION_RD_HEADER_MAX_TYPE_LENGTH "256" CACHE STRING
        "Readable data type header maximum length.")

concrete_compile_definitions (
        PRIVATE
        KAN_SERIALIZATION_BINARY_SCRIPT_INITIAL_BUCKETS=${KAN_SERIALIZATION_BINARY_SCRIPT_INITIAL_BUCKETS}
        KAN_SERIALIZATION_BINARY_GENERATION_INITIAL_STACK=${KAN_SERIALIZATION_BINARY_GENERATION_INITIAL_STACK}
        KAN_SERIALIZATION_BINARY_INTERNED_STRING_BUCKETS=${KAN_SERIALIZATION_BINARY_INTERNED_STRING_BUCKETS}
        KAN_SERIALIZATION_BINARY_INTERNED_STRING_CAPACITY=${KAN_SERIALIZATION_BINARY_INTERNED_STRING_CAPACITY}
        KAN_SERIALIZATION_BINARY_INTERNED_REGISTRY_BUCKETS=${KAN_SERIALIZATION_BINARY_INTERNED_REGISTRY_BUCKETS}
        KAN_SERIALIZATION_RD_MAX_PARTS_IN_OUTPUT_TARGET=${KAN_SERIALIZATION_RD_MAX_PARTS_IN_OUTPUT_TARGET}
        KAN_SERIALIZATION_RD_READER_STACK_INITIAL_CAPACITY=${KAN_SERIALIZATION_RD_READER_STACK_INITIAL_CAPACITY}
        KAN_SERIALIZATION_RD_WRITE_MAX_PACKED_ARRAY_SIZE=${KAN_SERIALIZATION_RD_WRITE_MAX_PACKED_ARRAY_SIZE}
        KAN_SERIALIZATION_RD_WRITER_STACK_INITIAL_CAPACITY=${KAN_SERIALIZATION_RD_WRITER_STACK_INITIAL_CAPACITY}
        KAN_SERIALIZATION_RD_HEADER_MAX_TYPE_LENGTH=${KAN_SERIALIZATION_RD_HEADER_MAX_TYPE_LENGTH}
)
